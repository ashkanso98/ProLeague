@model IEnumerable<ProLeague.Domain.Entities.Team>

@{
    var sortedTeams = Model
        .OrderByDescending(t => t.Points)
        .ThenByDescending(t => t.GoalDifference)
        .ThenByDescending(t => t.GoalsFor)
        .ToList();
}

<style>
    .league-table-mobile-header {
        display: flex;
        justify-content: space-between;
        padding: 10px 15px;
        background-color: #f8f9fa;
        font-weight: bold;
        border-bottom: 1px solid #dee2e6;
        position: sticky;
        top: 0;
        z-index: 10;
    }

    .league-table-mobile-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 15px;
        border-bottom: 1px solid #dee2e6;
    }

        /* یکی در میان رنگی برای موبایل */
        .league-table-mobile-row:nth-child(odd) {
            background-color: #ffffff;
        }

        .league-table-mobile-row:nth-child(even) {
            background-color: #f2f2f2;
        }

    .league-table-mobile-team {
        display: flex;
        align-items: center;
        flex: 1;
        min-width: 0;
    }

    .league-table-mobile-stats {
        display: flex;
        justify-content: flex-end;
        width: 35%;
    }

    .league-table-mobile-stat {
        width: 40px;
        text-align: center;
        font-weight: bold;
    }

    .league-table-logo {
        height: 40px;
        object-fit: contain;
    }

    .mobile-rank-badge {
        width: 28px;
        height: 28px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: black;
        border-radius: 4px;
        font-size: 0.9rem;
        font-weight: bold;
        margin-right: 10px;
    }

    .team-name {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: calc(100% - 100px);
    }

    @@media (max-width: 767px) {
        .league-table-logo {
            height: 35px;
        }
    }
</style>

<!-- Desktop version -->
<div class="d-none d-md-block">
    <div class="table-responsive">
        <table class="table table-hover table-striped align-middle text-center">
            <thead class="table-light">
                <tr>
                    <th scope="col" style="width:5%;">#</th>
                    <th scope="col" class="text-start" style="width:35%;">تیم</th>
                    <th scope="col" title="تعداد بازی">تعداد بازی</th>
                    <th scope="col" title="برد">برد</th>
                    <th scope="col" title="مساوی">مساوی</th>
                    <th scope="col" title="باخت">باخت</th>
                    <th scope="col" title="تفاضل گل">تفاضل گل</th>
                    <th scope="col" title="امتیاز">امتیاز</th>
                </tr>
            </thead>
            <tbody>
                @for (int i = 0; i < sortedTeams.Count; i++)
                {
                    var team = sortedTeams[i];
                    var rank = i + 1;

                    <tr>
                        <th scope="row">@rank</th>
                        <td class="text-start">
                            <a asp-controller="Team" asp-action="Details" asp-route-id="@team.Id"
                               class="text-decoration-none text-dark fw-bold d-flex align-items-center">
                                <img src="@(team.ImagePath ?? "/images/default-logo.png")"
                                     class="me-2" alt="@team.Name" height="50" />
                                <span>@team.Name</span>
                            </a>
                        </td>
                        <td>@team.Played</td>
                        <td>@team.Wins</td>
                        <td>@team.Draws</td>
                        <td>@team.Losses</td>
                        <td>@team.GoalDifference</td>
                        <td class="fw-bold">@team.Points</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<!-- Mobile version -->
<div class="d-md-none">
    <div class="rounded border mb-4">
        <!-- Header row -->
        <div class="league-table-mobile-header">
            <div class="league-table-mobile-team">
                <span style="width:28px; margin-right:10px;">#</span>
                <span>تیم</span>
            </div>
            <div class="league-table-mobile-stats">
                <div class="league-table-mobile-stat" title="تعداد بازی">بازی</div>
                <div class="league-table-mobile-stat" title="امتیاز">امتیاز</div>
            </div>
        </div>

        <!-- Team rows -->
        @for (int i = 0; i < sortedTeams.Count; i++)
        {
            var team = sortedTeams[i];
            var rank = i + 1;

            <a asp-controller="Team" asp-action="Details" asp-route-id="@team.Id"
               class="text-decoration-none text-dark">
                <div class="league-table-mobile-row">
                    <div class="league-table-mobile-team">
                        <div class="mobile-rank-badge">@rank</div>
                        <img src="@(team.ImagePath ?? "/images/default-logo.png")"
                             class="league-table-logo me-2" alt="@team.Name" />
                        <div class="team-name fw-bold">@team.Name</div>
                    </div>
                    <div class="league-table-mobile-stats">
                        <div class="league-table-mobile-stat">@team.Played</div>
                        <div class="league-table-mobile-stat text-primary fw-bold">@team.Points</div>
                    </div>
                </div>
            </a>
        }
    </div>
</div>
